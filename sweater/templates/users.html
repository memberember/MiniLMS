<!--index-->

{% extends 'base.html' %}

{% block title %}
    <title>Посещение студентов общежития</title>
    <script type=text/javascript src="{{ url_for('static', filename='js/jquery-2.2.2.min.js') }}"></script>
{% endblock %}
<script>
    function process(form) {
        $.ajax({
            type: "POST",
            url: "/process",
            data: $(form).serialize(),
            type: 'POST',
            success: function (response) {
                var json = jQuery.parseJSON(response)
                $('#len').html(json.len)

                console.log(response);
            },
            error: function (error) {
                console.log(error);
            }
        });
    }
</script>

{#Контент администратора#}
{% block admin %}

    <div class="container">
        <table class="table table-striped table-sm">
            <thead>

            {#Заголовки таблицы#}
            <tr>
                <th>#</th>
                <th>Имя пользователя</th>
                <th>Тип пользователя</th>
                <th>Редактирование</th>
            </tr>
            </thead>
            <tbody>

            {#Содержимое таблицы#}
            {% for el in data %}
                <tr>
                    <form action="/process" method='post' name='form{{ el.id }}'>
                        <td>{{ el.id }}</td>
                        <input type="hidden" name="user_id" id="user_id" value='{{ el.id }}' id="minput"/>
                        <td><input type="text" class="form-control" name="fio" id="fio" placeholder="Введите ФИО"
                                   value='{{ el.fio }}'>
                        </td>
                        <td>
                            <div class="form-group">
                                <select name="user_type" id="user_type" class="form-control">
                                    {% if el.type==0 %}
                                        <option selected>Администратор</option>
                                        <option>Преподаватель</option>
                                        <option>Студент</option>
                                    {% elif el.type==1 %}
                                        <option>Администратор</option>
                                        <option selected>Преподаватель</option>
                                        <option>Студент</option>
                                    {% else %}
                                        <option>Администратор</option>
                                        <option>Преподаватель</option>
                                        <option selected>Студент</option>
                                    {% endif %}
                                </select></div>
                        </td>
                        <td>

                            {#Кнопки редактирования#}
                            <button type="button" class="btn btn-danger">Удалить</button>
                            <button class="btn btn-success" onclick="process();">Сохранить</button>
                        </td>
                    </form>
                </tr>
            {% endfor %}

            </tbody>
        </table>
    </div>
{% endblock %}


{#Контент учителя и студента#}
{% block user %}
    <div class="container">
        <table class="table table-striped table-sm">
            <thead>

            {#Заголовки таблицы#}
            <tr>
                <th>#</th>
                <th>Имя пользователя</th>
                <th>Тип пользователя</th>
            </tr>
            </thead>
            <tbody>
            {% for el in data %}
                <tr>
                    <form action="/process" method='post' name='form{{ el.id }}'>
                        <td>{{ el.id }}</td>
                        <td>
                            {{ el.fio }}
                        </td>
                        <td>
                            {% if el.type == 0 %}
                                Администратор
                            {% elif el.type == 1 %}
                                Преподаватель
                            {% elif el.type == 2 %}
                                Студент
                            {% endif %}
                        </td>
                    </form>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
